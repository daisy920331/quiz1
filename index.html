<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>選擇題小遊戲（手機大按鈕＋連續加分）</title>
  <style>
    :root{
      --card:#ffffff;
      --bg:#e9f7ff;
      --ink:#0f172a;
      --muted:#64748b;
      --good:#16a34a;
      --bad:#dc2626;
      --brand:#0ea5e9;
      --line:#e2e8f0;
      --soft:#f8fafc;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      background: linear-gradient(180deg, var(--bg), #ffffff);
      color: var(--ink);
    }
    .wrap{ max-width: 980px; margin:0 auto; padding: 20px; }
    .header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      margin-bottom: 14px; flex-wrap:wrap;
    }
    .title{ display:flex; align-items:center; gap:10px; font-size: 20px; font-weight: 900; }
    .badge{
      font-size: 12px; color: #0369a1; background:#dbeafe;
      padding: 4px 10px; border-radius: 999px; font-weight: 800;
    }
    .stats{ display:flex; gap:10px; align-items:center; color:var(--muted); font-weight: 800; flex-wrap:wrap; }
    .pill{
      background:#f1f5f9; border:1px solid var(--line);
      padding: 6px 10px; border-radius: 999px;
    }
    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: 18px;
      box-shadow: 0 10px 25px rgba(2, 132, 199, 0.08);
      padding: 16px;
    }
    .row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .qno{ color:var(--brand); font-weight: 900; }
    .question{
      font-size: 20px; font-weight: 900; line-height: 1.45;
      margin: 10px 0 14px;
    }
    .options{ display:grid; gap:10px; margin-top: 8px; }
    button.opt{
      width:100%;
      text-align:left;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: #ffffff;
      cursor:pointer;
      font-size: 16px;
      font-weight: 800;
      display:flex;
      align-items:flex-start;
      gap:10px;
      transition: transform .05s ease, border-color .2s ease, background .2s ease;
    }
    button.opt:hover{ border-color:#93c5fd; background: var(--soft); }
    button.opt:active{ transform: scale(0.99); }
    button.opt:disabled{ cursor:not-allowed; opacity: .92; }
    .key{
      flex: 0 0 auto;
      width: 30px; height: 30px;
      border-radius: 10px;
      display:inline-grid; place-items:center;
      background:#f1f5f9; border:1px solid var(--line);
      color:var(--ink); font-weight: 900;
      margin-top: 1px;
    }
    .feedback{
      margin-top: 14px;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: var(--soft);
      display:none;
      font-weight: 900;
      line-height: 1.4;
    }
    .feedback.ok{ border-color:#bbf7d0; background:#f0fdf4; color:#166534; display:block; }
    .feedback.no{ border-color:#fecaca; background:#fef2f2; color:#991b1b; display:block; }

    .actions{ display:flex; gap:10px; justify-content:flex-end; margin-top: 14px; flex-wrap:wrap; }
    .btn{
      border: 1px solid var(--line);
      background: var(--brand);
      color:white;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 900;
      cursor:pointer;
    }
    .btn.secondary{ background:#ffffff; color:var(--ink); }
    .btn:disabled{ opacity:.5; cursor:not-allowed; }

    .progress{ height: 10px; width: 100%; background: var(--line); border-radius: 999px; overflow:hidden; margin-top: 12px; }
    .bar{ height:100%; width:0%; background: linear-gradient(90deg, #22c55e, var(--brand)); transition: width .35s ease; }

    .start{ display:grid; gap:10px; text-align:center; padding: 14px; }
    .big{ font-size: 26px; font-weight: 950; margin: 4px 0 0; }
    .sub{ color:var(--muted); font-weight: 800; margin: 0; }

    .footer-note{ margin-top:10px; color:var(--muted); font-size: 12px; font-weight: 800; }

    /* ✅ 手機專用大按鈕版（<=600px） */
    @media (max-width: 600px){
      .wrap{ padding: 14px; }
      .title{ font-size: 18px; }
      .question{ font-size: 22px; }
      button.opt{
        font-size: 18px;
        padding: 18px 16px;
        border-radius: 16px;
      }
      .key{
        width: 38px; height: 38px;
        border-radius: 12px;
        font-size: 16px;
      }
      .btn{
        width: 100%;
        padding: 14px 16px;
        font-size: 16px;
        border-radius: 14px;
      }
      .actions{ justify-content:stretch; }
      .pill{ font-size: 13px; }
      .card{ padding: 16px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="title">
        <span>練習・選擇題小遊戲</span>
        <span class="badge" id="modeBadge">選項隨機</span>
      </div>
      <div class="stats">
        <span class="pill">分數：<span id="score">0</span></span>
        <span class="pill">連續：<span id="streak">0</span></span>
        <span class="pill">進度：<span id="progressText">0/0</span></span>
      </div>
    </div>

    <div class="card" id="card"></div>
    <div class="footer-note">
      連續答對加分規則：連續達到 2、3、4、5 題時，分別額外 +1、+1、+1、+2（你可在 JS 內調整）。
    </div>
  </div>

  <script>
    // ✅ 題庫：每個選項帶 correct:true/false（這樣洗牌後仍知道答案）
    const QUESTIONS = [
      {
        q: "哪一個是神話故事？",
        options: [
          { text: "描寫神明與英雄的故事", correct: true },
          { text: "今天的天氣報告", correct: false },
          { text: "數學作業", correct: false }
        ]
      },
      {
        q: "部落的人通常會：",
        options: [
          { text: "住在同一個地方，有共同文化", correct: true },
          { text: "每個人獨自生活，互不交流", correct: false },
          { text: "只吃蔬菜，不吃肉", correct: false }
        ]
      },
      {
        q: "誰有權勢？",
        options: [
          { text: "可以影響很多人決定的人", correct: true },
          { text: "喜歡唱歌的人", correct: false },
          { text: "喜歡畫畫的人", correct: false }
        ]
      },
      {
        q: "太陽可以＿＿＿天空。",
        options: [
          { text: "主宰", correct: true },
          { text: "玩", correct: false },
          { text: "折", correct: false }
        ]
      },
      {
        q: "戰爭通常發生在：",
        options: [
          { text: "國家或部族之間爭鬥", correct: false },
          { text: "學校上課", correct: false },
          { text: "河流流動", correct: true }
        ]
      },
      {
        q: "哪一個是變動的例子？",
        options: [
          { text: "四季更替", correct: true },
          { text: "每天吃同樣的早餐", correct: false },
          { text: "門一直關著", correct: false }
        ]
      }
    ];

    // ✅ 連續答對加分規則（可自行改）
    // key = 連續答對數，value = 額外加分
    const STREAK_BONUS = {
      2: 1,
      3: 1,
      4: 1,
      5: 2
    };

    // --- 遊戲狀態 ---
    let deck = [];
    let idx = 0;
    let score = 0;
    let streak = 0;
    let locked = false;

    const $card = document.getElementById("card");
    const $score = document.getElementById("score");
    const $streak = document.getElementById("streak");
    const $progressText = document.getElementById("progressText");
    const $modeBadge = document.getElementById("modeBadge");

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function resetGame(){
      deck = shuffle(QUESTIONS);
      idx = 0;
      score = 0;
      streak = 0;
      locked = false;

      $modeBadge.textContent = "選項隨機・連續加分";
      $score.textContent = score;
      $streak.textContent = streak;
      $progressText.textContent = `0/${deck.length}`;

      renderStart();
    }

    function renderStart(){
      $card.innerHTML = `
        <div class="start">
          <div class="big">準備好了嗎？</div>
          <p class="sub">共 ${deck.length} 題｜每題選項會洗牌｜答對 +1 分</p>
          <p class="sub">連續答對會額外加分（看下方規則）</p>
          <div class="actions" style="justify-content:center;">
            <button class="btn" id="startBtn">開始遊戲</button>
            <button class="btn secondary" id="reshuffleBtn">重新洗牌題目</button>
          </div>
        </div>
      `;
      document.getElementById("startBtn").onclick = () => renderQuestion();
      document.getElementById("reshuffleBtn").onclick = () => {
        deck = shuffle(QUESTIONS);
        idx = 0;
        $progressText.textContent = `0/${deck.length}`;
        renderStart();
      };
    }

    function renderQuestion(){
      locked = false;

      const item = deck[idx];
      const qno = idx + 1;

      // ✅ 選項洗牌（每次出題都會隨機）
      const shuffledOptions = shuffle(item.options);

      $progressText.textContent = `${qno}/${deck.length}`;

      const keys = ["A", "B", "C"];
      const optionsHTML = shuffledOptions.map((opt, i) => `
        <button class="opt" data-correct="${opt.correct}">
          <span class="key">${keys[i]}</span>
          <span>${opt.text}</span>
        </button>
      `).join("");

      $card.innerHTML = `
        <div class="row">
          <div class="qno">第 ${qno} 題</div>
          <div class="pill" style="color:var(--brand); font-weight:950;">連續：${streak}</div>
        </div>

        <div class="question">${item.q}</div>

        <div class="options">${optionsHTML}</div>

        <div id="feedback" class="feedback"></div>

        <div class="actions">
          <button class="btn secondary" id="skipBtn">跳過（不計分）</button>
          <button class="btn" id="nextBtn" disabled>下一題</button>
        </div>

        <div class="progress" aria-label="progress">
          <div class="bar" id="bar"></div>
        </div>
      `;

      // 進度條
      const pct = Math.round(((idx) / deck.length) * 100);
      document.getElementById("bar").style.width = pct + "%";

      function disableAllOptions(){
        document.querySelectorAll("button.opt").forEach(b => b.disabled = true);
      }

      function highlightCorrect(){
        document.querySelectorAll("button.opt").forEach(b => {
          if (b.dataset.correct === "true") b.style.borderColor = "var(--good)";
        });
      }

      // 綁定選項
      document.querySelectorAll("button.opt").forEach(btn => {
        btn.addEventListener("click", () => {
          if (locked) return;
          locked = true;

          const isCorrect = btn.dataset.correct === "true";
          const fb = document.getElementById("feedback");
          const nextBtn = document.getElementById("nextBtn");

          if (isCorrect) {
            streak += 1;
            let add = 1; // 基本 +1
            const bonus = STREAK_BONUS[streak] || 0;
            add += bonus;

            score += add;

            $score.textContent = score;
            $streak.textContent = streak;

            fb.className = "feedback ok";
            fb.textContent = bonus > 0
              ? `✅ 答對了！+1 分，連續 ${streak} 題，額外獎勵 +${bonus}（本題共 +${add}）`
              : `✅ 答對了！+1 分（連續 ${streak} 題）`;
          } else {
            streak = 0;
            $streak.textContent = streak;

            fb.className = "feedback no";
            fb.textContent = `❌ 答錯了！連續歸零。`;
          }

          disableAllOptions();
          highlightCorrect();
          nextBtn.disabled = false;
        });
      });

      // 跳過：不計分，但連續歸零（比較公平；若你想跳過不歸零，我也可幫你改）
      document.getElementById("skipBtn").onclick = () => {
        streak = 0;
        $streak.textContent = streak;
        if (idx < deck.length - 1) {
          idx++;
          renderQuestion();
        } else {
          renderEnd();
        }
      };

      document.getElementById("nextBtn").onclick = () => {
        if (idx < deck.length - 1) {
          idx++;
          renderQuestion();
        } else {
          renderEnd();
        }
      };
    }

    function renderEnd(){
      const total = deck.length;
      const pct = Math.round((score / (total)) * 100);

      $card.innerHTML = `
        <div class="start">
          <div class="big">遊戲結束！</div>
          <p class="sub">你的分數：<b style="color:var(--brand);">${score}</b>（共 ${total} 題）</p>
          <p class="sub">最後連續：<b style="color:var(--brand);">${streak}</b></p>

          <div class="actions" style="justify-content:center;">
            <button class="btn" id="restartBtn">再玩一次</button>
            <button class="btn secondary" id="reviewBtn">查看題目與答案</button>
          </div>

          <div id="review" style="display:none; text-align:left; margin-top:10px;"></div>
        </div>
      `;

      document.getElementById("restartBtn").onclick = resetGame;

      document.getElementById("reviewBtn").onclick = () => {
        const box = document.getElementById("review");
        box.style.display = box.style.display === "none" ? "block" : "none";

        box.innerHTML = `
          <div class="pill" style="display:inline-block; margin-bottom:10px;">本次題目順序（答案以「內容」為準）</div>
          <div style="display:grid; gap:10px;">
            ${deck.map((it, i) => {
              const ans = it.options.find(o => o.correct);
              return `
                <div style="border:1px solid var(--line); border-radius:14px; padding:10px;">
                  <div style="font-weight:950; color:var(--brand);">${i+1}. ${it.q}</div>
                  <div style="color:var(--muted); font-weight:800; margin-top:4px;">
                    正確答案：${ans ? ans.text : "（未設定）"}
                  </div>
                </div>
              `;
            }).join("")}
          </div>
        `;
      };
    }

    // init
    resetGame();
  </script>
</body>
</html>

